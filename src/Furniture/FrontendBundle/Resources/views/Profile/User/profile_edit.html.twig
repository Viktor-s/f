{% extends 'FrontendBundle:Profile/User:base.html.twig' %}

{% block title %}{{ 'frontend.edit'|trans }} :: {{ parent() }}{% endblock %}

{% block breadcrumb %}
    {{ parent() }}

    <a href="#">{{ 'frontend.edit'|trans }}</a>
{% endblock %}

{% block page_content %}
    <form class="form" method="POST" action="" data-confirm>
        {% if form.vars.errors|length > 0 %}
            {{ form_errors(form) }}
        {% endif %}

        {{ form_row(form.email) }}
        {{ form_row(form.firstName) }}
        {{ form_row(form.lastName) }}
        {{ form_row(form.retailerUserProfile.position) }}
        {{ form_row(form.retailerUserProfile.phones) }}

        {{ form_rest(form) }}

        <div class="text-center">
            <input type="submit" class="btn btn-success" value="Save" />
        </div>
    </form>
    <script>
        (function($) {
            var email = "{{ app.user.email }}";
            $('form[data-confirm]').on('submit', function(e) {
                var newEmail = $(this).find('#frontend_user_profile_type_email').val();
                if (email !== newEmail) {
                    $(this).data('confirm', true);
                    $(this).data('message', "{{ 'frontend.retailer_profile_side.managers.email_change_confirmation'|trans }}");
                }
                else {
                    $(this).data('confirm', false);
                    $(this).data('message', "");
                }
            });
        })(jQuery);
    </script>
{% endblock %}